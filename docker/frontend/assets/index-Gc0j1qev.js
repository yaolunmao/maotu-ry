import{s as w,g as M}from"./project-J1lw65wD.js";import{a as x,u as y,r as o,H as R,I as k,o as J,c as O,h as r,w as f,i as c,aT as P,aU as C,aV as E,a6 as S}from"./index-_GLIFr1R.js";import{_ as V}from"./device-bind.vue_vue_type_script_setup_true_lang-qBQtT87O.js";import"./svgnode-ecd8D-XT.js";const I={style:{width:"100%",height:"100vh"}},q={__name:"index",setup(N){const v=x(),g=y(),n=o(),p=o(),a=o(""),u=o({}),d=o(!0),i=o(!1),_=()=>{console.log("点击了返回按钮"),v.go(-1)},m=e=>{u.value=JSON.parse(JSON.stringify(e)),i.value=!0},h=e=>{console.log("点击了保存按钮，可以在此处将图存到数据库",e),w({projectId:a.value,dataModel:JSON.stringify(e)}).then(t=>{S.success("保存成功！")})},j=()=>{M(a.value).then(e=>{var t,s;e.data.dataModel?(t=n.value)==null||t.setImportJson(JSON.parse(e.data.dataModel)):(s=n.value)==null||s.setImportJson({canvasCfg:{width:1920,height:1080,scale:1,color:"",img:"",guide:!0,adsorp:!0,adsorp_diff:3,transform_origin:{x:0,y:0},drag_offset:{x:0,y:0}},gridCfg:{enabled:!0,align:!0,size:10},json:[]}),d.value=!1})};return a.value=g.query.project_id,j(),(e,t)=>{const s=R("loading");return k((J(),O("div",I,[r(c(P),{ref_key:"MtEditRef",ref:n,onOnReturnClick:_,onOnSaveClick:h,onOnPreviewClick:m},{deviceBind:f(({item:l})=>[r(V,{"hand-item-info":l,"project-id":a.value},null,8,["hand-item-info","project-id"])]),_:1},512),r(c(E),{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),title:"预览",fullscreen:""},{default:f(()=>[r(c(C),{"export-json":u.value,ref_key:"MtPreviewRef",ref:p},null,8,["export-json"])]),_:1},8,["modelValue"])])),[[s,d.value]])}}};export{q as default};
