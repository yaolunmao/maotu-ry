import{d as ue,r as m,C as re,K as de,f as r,H as ie,o as s,c as y,I as T,J as I,i as a,h as l,w as t,j as se,L as D,k as w,M as x,n as p,D as A,l as pe,F as ce}from"./index-_GLIFr1R.js";import{l as me,g as fe,u as _e,a as ve,d as be}from"./device-odJQDp9N.js";const ge={class:"app-container"},ye={class:"dialog-footer"},we=ce({name:"Device"}),Ce=Object.assign(we,{setup(he){const{proxy:c}=ue(),{webtopo_device_type:S,webtopo_device_state:U}=c.useDict("webtopo_device_type","webtopo_device_state"),E=m([]),f=m(!1),R=m(!0),h=m(!0),$=m([]),K=m(!0),L=m(!0),N=m(0),B=m(""),H=re({form:{},queryParams:{pageNum:1,pageSize:10,name:null,type:null,state:null},rules:{name:[{required:!0,message:"设备名称不能为空",trigger:"blur"}]}}),{queryParams:o,form:u,rules:J}=de(H);function v(){R.value=!0,me(o.value).then(d=>{E.value=d.rows,N.value=d.total,R.value=!1})}function M(){f.value=!1,q()}function q(){u.value={id:null,name:null,type:null,createBy:null,createTime:null,updateBy:null,updateTime:null,state:null,remark:null},c.resetForm("deviceRef")}function F(){o.value.pageNum=1,v()}function O(){c.resetForm("queryRef"),F()}function G(d){$.value=d.map(n=>n.id),K.value=d.length!=1,L.value=!d.length}function W(){q(),f.value=!0,B.value="添加设备列表"}function P(d){q();const n=d.id||$.value;fe(n).then(g=>{u.value=g.data,f.value=!0,B.value="修改设备列表"})}function X(){c.$refs.deviceRef.validate(d=>{d&&(u.value.id!=null?_e(u.value).then(n=>{c.$modal.msgSuccess("修改成功"),f.value=!1,v()}):ve(u.value).then(n=>{c.$modal.msgSuccess("新增成功"),f.value=!1,v()}))})}function z(d){const n=d.id||$.value;c.$modal.confirm('是否确认删除设备列编号为"'+n+'"的数据项？').then(function(){return be(n)}).then(()=>{v(),c.$modal.msgSuccess("删除成功")}).catch(()=>{})}function Y(){c.download("webtopo/device/export",{...o.value},`device_${new Date().getTime()}.xlsx`)}return v(),(d,n)=>{const g=r("el-input"),_=r("el-form-item"),k=r("el-option"),V=r("el-select"),i=r("el-button"),Q=r("el-form"),C=r("el-col"),Z=r("right-toolbar"),ee=r("el-row"),b=r("el-table-column"),j=r("dict-tag"),le=r("el-table"),ae=r("pagination"),te=r("el-dialog"),ne=ie("loading");return s(),y("div",ge,[T(l(Q,{model:a(o),ref:"queryRef",inline:!0,"label-width":"68px"},{default:t(()=>[l(_,{label:"设备名称",prop:"name"},{default:t(()=>[l(g,{modelValue:a(o).name,"onUpdate:modelValue":n[0]||(n[0]=e=>a(o).name=e),placeholder:"请输入设备名称",clearable:"",onKeyup:se(F,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(_,{label:"设备分类",prop:"type"},{default:t(()=>[l(V,{modelValue:a(o).type,"onUpdate:modelValue":n[1]||(n[1]=e=>a(o).type=e),placeholder:"请选择设备分类",clearable:""},{default:t(()=>[(s(!0),y(D,null,x(a(S),e=>(s(),w(k,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(_,{label:"设备状态",prop:"state"},{default:t(()=>[l(V,{modelValue:a(o).state,"onUpdate:modelValue":n[2]||(n[2]=e=>a(o).state=e),placeholder:"请选择设备状态",clearable:""},{default:t(()=>[(s(!0),y(D,null,x(a(U),e=>(s(),w(k,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(_,null,{default:t(()=>[l(i,{type:"primary",icon:"Search",onClick:F},{default:t(()=>[p("搜索")]),_:1}),l(i,{icon:"Refresh",onClick:O},{default:t(()=>[p("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[I,a(h)]]),l(ee,{gutter:10,class:"mb8"},{default:t(()=>[l(C,{span:1.5},{default:t(()=>[l(i,{type:"primary",plain:"",icon:"Plus",onClick:W},{default:t(()=>[p("新增")]),_:1})]),_:1}),l(C,{span:1.5},{default:t(()=>[l(i,{type:"success",plain:"",icon:"Edit",disabled:a(K),onClick:P},{default:t(()=>[p("修改")]),_:1},8,["disabled"])]),_:1}),l(C,{span:1.5},{default:t(()=>[l(i,{type:"danger",plain:"",icon:"Delete",disabled:a(L),onClick:z},{default:t(()=>[p("删除")]),_:1},8,["disabled"])]),_:1}),l(C,{span:1.5},{default:t(()=>[l(i,{type:"warning",plain:"",icon:"Download",onClick:Y},{default:t(()=>[p("导出")]),_:1})]),_:1}),l(Z,{showSearch:a(h),"onUpdate:showSearch":n[3]||(n[3]=e=>A(h)?h.value=e:null),onQueryTable:v},null,8,["showSearch"])]),_:1}),T((s(),w(le,{data:a(E),onSelectionChange:G},{default:t(()=>[l(b,{type:"selection",width:"55",align:"center"}),l(b,{label:"设备id",align:"center",prop:"id"}),l(b,{label:"设备名称",align:"center",prop:"name"}),l(b,{label:"设备分类",align:"center",prop:"type"},{default:t(e=>[l(j,{options:a(S),value:e.row.type},null,8,["options","value"])]),_:1}),l(b,{label:"设备状态",align:"center",prop:"state"},{default:t(e=>[l(j,{options:a(U),value:e.row.state},null,8,["options","value"])]),_:1}),l(b,{label:"备注",align:"center",prop:"remark"}),l(b,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(e=>[l(i,{link:"",type:"primary",icon:"Edit",onClick:oe=>P(e.row)},{default:t(()=>[p("修改")]),_:2},1032,["onClick"]),l(i,{link:"",type:"primary",icon:"Delete",onClick:oe=>z(e.row)},{default:t(()=>[p("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ne,a(R)]]),T(l(ae,{total:a(N),page:a(o).pageNum,"onUpdate:page":n[4]||(n[4]=e=>a(o).pageNum=e),limit:a(o).pageSize,"onUpdate:limit":n[5]||(n[5]=e=>a(o).pageSize=e),onPagination:v},null,8,["total","page","limit"]),[[I,a(N)>0]]),l(te,{title:a(B),modelValue:a(f),"onUpdate:modelValue":n[10]||(n[10]=e=>A(f)?f.value=e:null),width:"500px","append-to-body":""},{footer:t(()=>[pe("div",ye,[l(i,{type:"primary",onClick:X},{default:t(()=>[p("确 定")]),_:1}),l(i,{onClick:M},{default:t(()=>[p("取 消")]),_:1})])]),default:t(()=>[l(Q,{ref:"deviceRef",model:a(u),rules:a(J),"label-width":"80px"},{default:t(()=>[l(_,{label:"设备名称",prop:"name"},{default:t(()=>[l(g,{modelValue:a(u).name,"onUpdate:modelValue":n[6]||(n[6]=e=>a(u).name=e),placeholder:"请输入设备名称"},null,8,["modelValue"])]),_:1}),l(_,{label:"设备分类",prop:"type"},{default:t(()=>[l(V,{modelValue:a(u).type,"onUpdate:modelValue":n[7]||(n[7]=e=>a(u).type=e),placeholder:"请选择设备分类"},{default:t(()=>[(s(!0),y(D,null,x(a(S),e=>(s(),w(k,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(_,{label:"设备状态",prop:"state"},{default:t(()=>[l(V,{modelValue:a(u).state,"onUpdate:modelValue":n[8]||(n[8]=e=>a(u).state=e),placeholder:"请选择设备状态"},{default:t(()=>[(s(!0),y(D,null,x(a(U),e=>(s(),w(k,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(_,{label:"备注",prop:"remark"},{default:t(()=>[l(g,{modelValue:a(u).remark,"onUpdate:modelValue":n[9]||(n[9]=e=>a(u).remark=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ce as default};
