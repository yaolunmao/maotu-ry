import{u as ce,d as pe,r as p,C as me,K as fe,a1 as _e,f as i,H as T,o as _,c as j,I as u,J as B,i as n,h as e,w as l,j as L,D as Y,n as g,k as v,A as G,l as M,L as be,M as ge,F as ve,a2 as he}from"./index-_GLIFr1R.js";import{a as ye,b as we,s as Ce,p as Ne,d as ke}from"./gen-rO8VcL_5.js";import xe from"./importTable-EqVISwBj.js";const Se={class:"app-container"},Ve=ve({name:"Gen"}),Re=Object.assign(Ve,{setup($e){const I=ce(),{proxy:s}=pe(),R=p([]),S=p(!0),N=p(!0),V=p([]),q=p(!0),U=p(!0),$=p(0),P=p([]),h=p([]),z=p(""),Q=me({queryParams:{pageNum:1,pageSize:10,tableName:void 0,tableComment:void 0},preview:{open:!1,title:"代码预览",data:{},activeName:"domain.java"}}),{queryParams:r,preview:m}=fe(Q);_e(()=>{const o=I.query.t;o!=null&&o!=z.value&&(z.value=o,r.value.pageNum=Number(I.query.pageNum),h.value=[],s.resetForm("queryForm"),y())});function y(){S.value=!0,ye(s.addDateRange(r.value,h.value)).then(o=>{R.value=o.rows,$.value=o.total,S.value=!1})}function w(){r.value.pageNum=1,y()}function K(o){const t=o.tableName||P.value;if(t==""){s.$modal.msgError("请选择要生成的数据");return}o.genType==="1"?we(o.tableName).then(D=>{s.$modal.msgSuccess("成功生成到自定义路径："+o.genPath)}):s.$download.zip("/tool/gen/batchGenCode?tables="+t,"ruoyi.zip")}function A(o){const t=o.tableName;s.$modal.confirm('确认要强制同步"'+t+'"表结构吗？').then(function(){return Ce(t)}).then(()=>{s.$modal.msgSuccess("同步成功")}).catch(()=>{})}function H(){s.$refs.importRef.show()}function J(){h.value=[],s.resetForm("queryRef"),w()}function W(o){Ne(o.tableId).then(t=>{m.value.data=t.data,m.value.open=!0,m.value.activeName="domain.java"})}function X(){s.$modal.msgSuccess("复制成功")}function Z(o){V.value=o.map(t=>t.tableId),P.value=o.map(t=>t.tableName),q.value=o.length!=1,U.value=!o.length}function O(o){const t=o.tableId||V.value[0];he.push({path:"/tool/gen-edit/index/"+t,query:{pageNum:r.value.pageNum}})}function E(o){const t=o.tableId||V.value;s.$modal.confirm('是否确认删除表编号为"'+t+'"的数据项？').then(function(){return ke(t)}).then(()=>{y(),s.$modal.msgSuccess("删除成功")}).catch(()=>{})}return y(),(o,t)=>{const D=i("el-input"),k=i("el-form-item"),ee=i("el-date-picker"),d=i("el-button"),te=i("el-form"),x=i("el-col"),le=i("right-toolbar"),ae=i("el-row"),b=i("el-table-column"),C=i("el-tooltip"),ne=i("el-table"),oe=i("pagination"),ie=i("el-link"),re=i("el-tab-pane"),ue=i("el-tabs"),se=i("el-dialog"),f=T("hasPermi"),de=T("loading"),F=T("copyText");return _(),j("div",Se,[u(e(te,{model:n(r),ref:"queryRef",inline:!0},{default:l(()=>[e(k,{label:"表名称",prop:"tableName"},{default:l(()=>[e(D,{modelValue:n(r).tableName,"onUpdate:modelValue":t[0]||(t[0]=a=>n(r).tableName=a),placeholder:"请输入表名称",clearable:"",style:{width:"200px"},onKeyup:L(w,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(k,{label:"表描述",prop:"tableComment"},{default:l(()=>[e(D,{modelValue:n(r).tableComment,"onUpdate:modelValue":t[1]||(t[1]=a=>n(r).tableComment=a),placeholder:"请输入表描述",clearable:"",style:{width:"200px"},onKeyup:L(w,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(k,{label:"创建时间",style:{width:"308px"}},{default:l(()=>[e(ee,{modelValue:n(h),"onUpdate:modelValue":t[2]||(t[2]=a=>Y(h)?h.value=a:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(d,{type:"primary",icon:"Search",onClick:w},{default:l(()=>[g("搜索")]),_:1}),e(d,{icon:"Refresh",onClick:J},{default:l(()=>[g("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[B,n(N)]]),e(ae,{gutter:10,class:"mb8"},{default:l(()=>[e(x,{span:1.5},{default:l(()=>[u((_(),v(d,{type:"primary",plain:"",icon:"Download",onClick:K},{default:l(()=>[g("生成")]),_:1})),[[f,["tool:gen:code"]]])]),_:1}),e(x,{span:1.5},{default:l(()=>[u((_(),v(d,{type:"info",plain:"",icon:"Upload",onClick:H},{default:l(()=>[g("导入")]),_:1})),[[f,["tool:gen:import"]]])]),_:1}),e(x,{span:1.5},{default:l(()=>[u((_(),v(d,{type:"success",plain:"",icon:"Edit",disabled:n(q),onClick:O},{default:l(()=>[g("修改")]),_:1},8,["disabled"])),[[f,["tool:gen:edit"]]])]),_:1}),e(x,{span:1.5},{default:l(()=>[u((_(),v(d,{type:"danger",plain:"",icon:"Delete",disabled:n(U),onClick:E},{default:l(()=>[g("删除")]),_:1},8,["disabled"])),[[f,["tool:gen:remove"]]])]),_:1}),e(le,{showSearch:n(N),"onUpdate:showSearch":t[3]||(t[3]=a=>Y(N)?N.value=a:null),onQueryTable:y},null,8,["showSearch"])]),_:1}),u((_(),v(ne,{data:n(R),onSelectionChange:Z},{default:l(()=>[e(b,{type:"selection",align:"center",width:"55"}),e(b,{label:"序号",type:"index",width:"50",align:"center"},{default:l(a=>[M("span",null,G((n(r).pageNum-1)*n(r).pageSize+a.$index+1),1)]),_:1}),e(b,{label:"表名称",align:"center",prop:"tableName","show-overflow-tooltip":!0}),e(b,{label:"表描述",align:"center",prop:"tableComment","show-overflow-tooltip":!0}),e(b,{label:"实体",align:"center",prop:"className","show-overflow-tooltip":!0}),e(b,{label:"创建时间",align:"center",prop:"createTime",width:"160"}),e(b,{label:"更新时间",align:"center",prop:"updateTime",width:"160"}),e(b,{label:"操作",align:"center",width:"330","class-name":"small-padding fixed-width"},{default:l(a=>[e(C,{content:"预览",placement:"top"},{default:l(()=>[u(e(d,{link:"",type:"primary",icon:"View",onClick:c=>W(a.row)},null,8,["onClick"]),[[f,["tool:gen:preview"]]])]),_:2},1024),e(C,{content:"编辑",placement:"top"},{default:l(()=>[u(e(d,{link:"",type:"primary",icon:"Edit",onClick:c=>O(a.row)},null,8,["onClick"]),[[f,["tool:gen:edit"]]])]),_:2},1024),e(C,{content:"删除",placement:"top"},{default:l(()=>[u(e(d,{link:"",type:"primary",icon:"Delete",onClick:c=>E(a.row)},null,8,["onClick"]),[[f,["tool:gen:remove"]]])]),_:2},1024),e(C,{content:"同步",placement:"top"},{default:l(()=>[u(e(d,{link:"",type:"primary",icon:"Refresh",onClick:c=>A(a.row)},null,8,["onClick"]),[[f,["tool:gen:edit"]]])]),_:2},1024),e(C,{content:"生成代码",placement:"top"},{default:l(()=>[u(e(d,{link:"",type:"primary",icon:"Download",onClick:c=>K(a.row)},null,8,["onClick"]),[[f,["tool:gen:code"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[de,n(S)]]),u(e(oe,{total:n($),page:n(r).pageNum,"onUpdate:page":t[4]||(t[4]=a=>n(r).pageNum=a),limit:n(r).pageSize,"onUpdate:limit":t[5]||(t[5]=a=>n(r).pageSize=a),onPagination:y},null,8,["total","page","limit"]),[[B,n($)>0]]),e(se,{title:n(m).title,modelValue:n(m).open,"onUpdate:modelValue":t[7]||(t[7]=a=>n(m).open=a),width:"80%",top:"5vh","append-to-body":"",class:"scrollbar"},{default:l(()=>[e(ue,{modelValue:n(m).activeName,"onUpdate:modelValue":t[6]||(t[6]=a=>n(m).activeName=a)},{default:l(()=>[(_(!0),j(be,null,ge(n(m).data,(a,c)=>(_(),v(re,{label:c.substring(c.lastIndexOf("/")+1,c.indexOf(".vm")),name:c.substring(c.lastIndexOf("/")+1,c.indexOf(".vm")),key:a},{default:l(()=>[u((_(),v(ie,{underline:!1,icon:"DocumentCopy",style:{float:"right"}},{default:l(()=>[g(" 复制")]),_:2},1024)),[[F,a],[F,X,"callback"]]),M("pre",null,G(a),1)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"]),e(n(xe),{ref:"importRef",onOk:w},null,512)])}}});export{Re as default};
